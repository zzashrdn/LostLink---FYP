{% extends "base.html" %}
{% block content %}

<!-- Hide flash messages -->
<style>.flash-wrap { display: none !important; }</style>

<div class="items-wrapper">
  <div class="items-box">
    <h2>Manage Reported Items</h2>

    <!-- ðŸ” Search & Filter Bar -->
    <div class="filter-bar">
      <input 
        type="text" 
        id="searchInput" 
        placeholder="Search item, location, or reporter..." 
        onkeyup="filterItems()" 
      />
      <select id="statusFilter" onchange="filterItems()">
        <option value="all">All Status</option>
        <option value="found">Found</option>
        <option value="lost">Lost</option>
        <option value="claimed">Claimed</option>
        <option value="pending">Pending</option>
      </select>
    </div>

    {% if items %}
      <div class="items-grid" id="itemsGrid">
        {% for item in items %}
        <div class="item-card" 
             data-status="{{ item[6]|lower }}" 
             data-text="{{ (item[1] ~ ' ' ~ item[2] ~ ' ' ~ item[3] ~ ' ' ~ item[7])|lower }}">
          
          {% if item[5] %}
          <img src="{{ url_for('static', filename='uploads/' ~ item[5]) }}" alt="Item photo">
          {% endif %}

          <h3>
            {{ item[1] }}
            {% if item[6] %}
              <span class="badge {{ item[6]|lower }}">{{ item[6]|capitalize }}</span>
            {% endif %}
          </h3>

          <p><strong>Description:</strong> {{ item[2] }}</p>
          <p><strong>Location:</strong> {{ item[3] }}</p>
          <p><strong>Reported by:</strong> {{ item[7] }} on {{ item[4] }}</p>

          <div class="action-btns">
            <a href="{{ url_for('admin_edit_item', item_id=item[0]) }}">
              <button class="edit-btn">Edit</button>
            </a>
            <form method="POST" action="{{ url_for('admin_delete_item', item_id=item[0]) }}" style="display:inline;">
              <button class="delete-btn" onclick="return confirm('Delete this item?')">Delete</button>
            </form>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No reported items found.</p>
    {% endif %}

    <a href="{{ url_for('admin_dashboard') }}">
      <button class="back-btn">Back to Dashboard</button>
    </a>
  </div>
</div>


<!-- ðŸ’… Styles -->
<style>
.items-wrapper {
  padding: 40px;
}

.filter-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  gap: 10px;
}

.filter-bar input,
.filter-bar select {
  padding: 10px 15px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 1rem;
}

.items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 25px;
  margin-top: 20px;
}

.item-card {
  background: white;
  border-radius: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  padding: 20px;
  transition: 0.3s ease;
}

.item-card:hover {
  transform: translateY(-3px);
}

.item-card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  border-radius: 10px;
  margin-bottom: 10px;
}

.badge {
  padding: 3px 10px;
  border-radius: 8px;
  font-size: 0.8rem;
  color: white;
}

.badge.found { background: #00b4d8; }
.badge.lost { background: #ff6b6b; }
.badge.claimed { background: #4cc9f0; }
.badge.pending { background: #f9c74f; color: #333; }

.action-btns {
  margin-top: 10px;
  display: flex;
  justify-content: space-between;
}

.edit-btn, .delete-btn, .back-btn {
  padding: 8px 14px;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
}

.edit-btn { background: #0077b6; color: white; }
.delete-btn { background: #e63946; color: white; }
.back-btn { background: #00b4d8; color: white; margin-top: 30px; }

.edit-btn:hover { background: #005f8d; }
.delete-btn:hover { background: #c1121f; }
.back-btn:hover { background: #0096c7; }
</style>

{% endblock %}
